!function(e){function t(t,o,n){var a=e(t).html(),c=Handlebars.compile(a)(o);e(n).html(c)}function o(o){e.getJSON(u,function(n){t("#sequence-template",n.cart[o],"#img-sequence"),e(".img-count").html(n.cart.length),t("#image-template",n.cart,"#goodsImage-ul"),e(".goodsImage-ul").css({width:2*n.cart.length*e(".goodsImage-div")[0].offsetWidth}),e(".goodsImage-ul").html(e(".goodsImage-ul").html()+e(".goodsImage-ul").html()),t("#name-template",n.cart[o],"#goods-name"),t("#price-template",n.cart[o],"#goods-price"),t("#count-template",n.cart[o],"#goods-count")})}function n(e,t,o){var n={x:5,y:5,sx:0,sy:0,ex:0,ey:0},a=0,c=0;t=t.toLowerCase(),e.addEventListener("touchstart",function(e){var e=e||event;a=(new Date).getTime(),n.sx=e.targetTouches[0].pageX,n.sy=e.targetTouches[0].pageY,n.ex=n.sx,n.ey=n.sy,-1!=t.indexOf("start")&&o()},"false"),e.addEventListener("touchmove",function(e){n.ex=e.targetTouches[0].pageX,n.ey=e.targetTouches[0].pageY,-1!=t.indexOf("move")&&o()},!1),e.addEventListener("touchend",function(){var e=n.ex-n.sx,l=n.ey-n.sy;Math.abs(e)>Math.abs(l)&&Math.abs(l)>n.y?e>0?-1!=t.indexOf("right")&&o():-1!=t.indexOf("left")&&o():Math.abs(l)>Math.abs(e)&&Math.abs(e)>n.x?l>0?-1!=t.indexOf("bottom")&&o():-1!=t.indexOf("top")&&o():Math.abs(e)<n.x&&Math.abs(l)<n.y&&((c=(new Date).getTime())-a>300?-1!=t.indexOf("long")&&o():-1!=t.indexOf("click")&&o())},!1)}function a(){var t=e(".goodsCount-value").html();t>1&&t--,e(".goodsCount-value").html(t)}function c(){var t=e(".goodsCount-value").html();t++,e(".goodsCount-value").html(t)}function l(){r&&(r=!1,d=++g,e(".goodsImage-ul").velocity({left:-g*e(".goodsImage-div")[0].offsetWidth},{duration:400,complete:function(){g==e(".goodsImage-ul li").length/2&&(d=g=0,e(".goodsImage-ul").css({left:0})),e(".now-sequence").html(g+1+"/"),r=!0}}),d==e(".goodsImage-ul li").length/2&&(d=0))}function i(){r&&(r=!1,0==g&&(g=e(".goodsImage-ul li").length/2,d=g,e(".goodsImage-ul").css({left:-g*e(".goodsImage-ul li")[0].offsetWidth})),d=--g,e(".goodsImage-ul").velocity({left:-g*e(".goodsImage-ul li")[0].offsetWidth},{duration:400,complete:function(){e(".now-sequence").html(g+1+"/"),r=!0}}))}function s(){m?(e(".overlap").css({display:"block"}),e(".paydetail").velocity({bottom:0},{duration:200})):(e(".overlap").css({display:"none"}),e(".paydetail").velocity({bottom:"-4rem"},{duration:200})),m=!m}var u="http://www.easy-mock.com/mock/598700b1a1d30433d856c3e5/cafe/dinTable/cart";e.ajaxSetup({error:function(){return alert("调用接口失败"),!1}}),o(0),Handlebars.registerHelper("addOne",function(e){return e+1});var g=0,d=g,r=!0,m=!0;n(e(".settlement")[0],"click",s),n(e(".overlap")[0],"click",s),n(e(".goodsImage-div")[0],"left",function(){l(),o(d)}),n(e(".left")[0],"click",function(){i(),o(d)}),n(e(".goodsImage-div")[0],"right",function(){i(),o(d)}),n(e(".right")[0],"click",function(){l(),o(d)}),n(e(".goods-count .iconfont:eq(0)")[0],"click",function(){a()}),n(e(".goods-count .iconfont:eq(1)")[0],"click",function(){c()});for(var f=document.querySelectorAll(".nav a"),h=0;h<f.length;h++)!function(t){n(f[t],"click",function(){e(f[t]).css("color","#d91c06"),e(f).not(f[t]).css("color","#2c2c2c")})}(h)}(jQuery);